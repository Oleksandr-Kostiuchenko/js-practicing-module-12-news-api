{"version":3,"file":"index.js","sources":["../src/js/news-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["//* Import libraries\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\n//* Export fetch function\nexport const fetchNews = async (userQuery, page) => {\n    const galleryData = await axios.get(`https://api.thenewsapi.com/v1/news/all?api_token=tcUbeilVimWPJx0gGV8QbLAhmBB3OykRPLRi7H5Z&search=${userQuery}&page=${page}&language=en`);\n\n    return galleryData;\n}\n\n//* Export fetch function with filter\nconst dateToday = new Date();\nconst formattedDate = dateToday.toISOString().split('T')[0]\n\nexport const fetchNewsByFilter = async (userQuery, page) => {\n    const galleryData = await axios.get(`https://api.thenewsapi.com/v1/news/all?api_token=tcUbeilVimWPJx0gGV8QbLAhmBB3OykRPLRi7H5Z&search=${userQuery}&page=${page}&language=en&published_on=${formattedDate}&sort=published_on`);\n\n    return galleryData;\n}\n\n//* Export fetch function with category\nexport const fetchNewsByCategory = async (userQuery, page, category) => {\n    const galleryData = await axios.get(`https://api.thenewsapi.com/v1/news/all?api_token=tcUbeilVimWPJx0gGV8QbLAhmBB3OykRPLRi7H5Z&search=${userQuery}&page=${page}&language=en&categories=${category}`);    \n\n    return galleryData;\n}\n\n//* Export fetch function with filter and category\nexport const fetchNewsByCategoryAndFilter = async (userQuery, page, category) => {\n    const galleryData = await axios.get(`https://api.thenewsapi.com/v1/news/all?api_token=tcUbeilVimWPJx0gGV8QbLAhmBB3OykRPLRi7H5Z&search=${userQuery}&page=${page}&language=en&published_on=${formattedDate}&sort=published_on&categories=${category}`);\n\n    return galleryData;\n}","//* Export render function\nexport const renderArticle = newsObj => {\n    const date = new Date(newsObj.published_at);\n    const formattedDate = date.toISOString().split('T')[0];\n\n    return `\n    <li class=\"article-item\">\n        <a class=\"aricle-title\" href=\"${newsObj.url}\" target=\"_blank\">${newsObj.title} - ${newsObj.source}</a>\n\n        <img class=\"article-image\" src=\"${newsObj.image_url}\" alt=\"news-image\">\n\n        <p class=\"article-description\">${newsObj.description}</p>\n        <p class=\"article-content\">${newsObj.snippet}</p>\n\n        <p class=\"article-date\">${formattedDate}</p>\n    </li>\n    `\n}","//TODO: Пошук новин з NewsAPI\n\n//* Import libraries\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\n//* Import modules\nimport { fetchNews, fetchNewsByFilter, fetchNewsByCategory, fetchNewsByCategoryAndFilter} from \"./js/news-api\";\nimport { renderArticle } from \"./js/render-functions\";\n\n//* Find elements\nconst formEl = document.querySelector('.news-form');\nconst inputEl = document.querySelector('.news-input');\nconst buttonEl = document.querySelector('.search-news-btn');\nconst newsListEl = document.querySelector('.news-list');\nconst loadMoreButtonEl = document.querySelector('.load-more-btn');\nconst loader = document.querySelector('.loader');\nconst loaderMore = document.querySelector('.loader-more');\n\n//* SortByDate settings\nconst checkboxEl = document.querySelector('#theme-switch');\nlet sortByDate = false;\n\nconst onCheckboxClick = event => {\n    if (checkboxEl.checked) {\n        sortByDate = true;\n    } else {\n        sortByDate = false;\n    }\n}\n\ncheckboxEl.addEventListener('click', onCheckboxClick); \n\n//* SortByCategory settings\nconst selectCategoryEl = document.querySelector('.category-select');\nlet FetchCategory = 'default';\n\nselectCategoryEl.addEventListener('input', event => {\n    FetchCategory = selectCategoryEl.value;\n})\n\n//* Function\nlet page = 1;\nlet userQuery;\nlet totalPages;\n\nconst onFormSubmit = async event => {\n    event.preventDefault();\n\n    loadMoreButtonEl.classList.add('is-hidden');\n    page = 1;\n    userQuery = inputEl.value.trim();\n    localStorage.setItem('userQuery', userQuery);\n    \n    if (userQuery === '') {\n        iziToast.error({\n            title: 'Error',\n            titleSize: '35',\n            message: 'Please fill the gap!',\n            messageSize: '30',\n            position: 'bottomRight'\n        });\n        return;\n    }\n\n    try {\n        loader.classList.remove('hidden');\n\n        let newsData;\n        if (sortByDate && FetchCategory !== 'default') {\n            newsData = await fetchNewsByCategoryAndFilter(userQuery, page, FetchCategory);\n        } else if (sortByDate) {\n            newsData = await fetchNewsByFilter(userQuery, page);\n        }  else if (FetchCategory !== 'default') {\n            newsData = await fetchNewsByCategory(userQuery, page, FetchCategory);\n        } else {\n            newsData = await fetchNews(userQuery, page);\n        }\n\n        loader.classList.add('hidden');\n\n        if (newsData.data.meta.found === 0) {\n            iziToast.error({\n                title: 'Error',\n                titleSize: '25',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                messageSize: '15',\n                position: 'bottomRight'\n            });\n            return;\n        }\n\n        newsListEl.innerHTML = ''\n        const newsHTML = [];\n        newsData.data.data.forEach(element => {\n            newsHTML.push(renderArticle(element));\n        });\n        \n        newsListEl.insertAdjacentHTML('beforeend', newsHTML.join(''))\n\n        window.scrollBy({\n            top: 500,\n            left: 0,\n            behavior: \"smooth\",\n        });\n\n        totalPages = Math.ceil(newsData.data.meta.found / 3);\n        iziToast.success({\n            message: `Sucess! ${totalPages * newsHTML.length} news are found!`,\n            messageSize: '30',\n            position: 'bottomRight'\n        });\n        \n        if (totalPages <= 1) {\n            return;\n        }\n        else if (page <= totalPages) {\n                if (page === totalPages) {\n                    loadMoreBtn.classList.add('is-hidden');\n                    loadMoreButtonEl.addEventListener('click', onLoadMoreBtnClick);\n                    return;\n                }\n\n            loadMoreButtonEl.classList.remove('is-hidden');\n\n            loadMoreButtonEl.removeEventListener('click', onLoadMoreBtnClick);\n            loadMoreButtonEl.addEventListener('click', onLoadMoreBtnClick);\n        }\n    } catch (err) {\n        iziToast.error({\n            message: 'Sorry! Something went wrong(',\n            messageSize: '30',\n            position: 'bottomRight'\n        });\n\n        return;\n    }\n};\n\nconst onLoadMoreBtnClick = async event => {\n    try {\n        page++;\n\n        loaderMore.classList.remove('hidden');\n\n        let newsData;\n        if (sortByDate && FetchCategory !== 'default') {\n            newsData = await fetchNewsByCategoryAndFilter(userQuery, page, FetchCategory);\n        } else if (sortByDate) {\n            newsData = await fetchNewsByFilter(userQuery, page);\n        }  else if (FetchCategory !== 'default') {\n            newsData = await fetchNewsByCategory(userQuery, page, FetchCategory);\n        } else {\n            newsData = await fetchNews(userQuery, page);\n        }\n\n        loaderMore.classList.add('hidden');\n\n        const newsHTML = []\n        newsData.data.data.forEach(element => {\n            newsHTML.push(renderArticle(element));\n        })\n\n        newsListEl.insertAdjacentHTML('beforeend', newsHTML.join(''));\n\n        const newsItem = document.querySelector('.article-item');\n        const rect = newsItem.getBoundingClientRect()\n\n        window.scrollBy({\n            top: rect.height,\n            left: 0,\n            behavior: \"smooth\",\n        });\n\n        if (page === totalPages) {\n            iziToast.info({\n                    title: '',\n                    titleSize: '25',\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    messageSize: '20',\n                    position: 'bottomRight'\n            });\n\n            loadMoreButtonEl.classList.add('is-hidden');\n            loadMoreButtonEl.removeEventListener('click', onLoadMoreBtnClick);\n            return;\n    }\n    } catch (err) {\n        console.log(err);\n    }\n}\n\n//* Restore user query\nconst restoreUserQuery = () => {\n    const userQueryFromLS = localStorage.getItem('userQuery');\n\n    if(userQueryFromLS === null){\n        return;\n    }\n\n    inputEl.value = userQueryFromLS;\n    onFormSubmit(new Event('submit'));\n}\n\nrestoreUserQuery()\n\n//* Add event listener \nformEl.addEventListener('submit', onFormSubmit)"],"names":["fetchNews","userQuery","page","axios","dateToday","formattedDate","fetchNewsByFilter","fetchNewsByCategory","category","fetchNewsByCategoryAndFilter","renderArticle","newsObj","formEl","inputEl","newsListEl","loadMoreButtonEl","loader","loaderMore","checkboxEl","sortByDate","onCheckboxClick","event","selectCategoryEl","FetchCategory","totalPages","onFormSubmit","iziToast","newsData","newsHTML","element","onLoadMoreBtnClick","rect","err","restoreUserQuery","userQueryFromLS"],"mappings":"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"}